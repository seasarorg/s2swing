<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" type="text/css" href="../css/style.css" />
	<link rel="stylesheet" type="text/css" href="../syntax/css/SyntaxHighlighter.css" />
	<script type="text/javascript" src="../syntax/js/shCore.js"></script>
	<script type="text/javascript" src="../syntax/js/shBrushJava.js"></script>
	<script type="text/javascript" src="../syntax/js/shBrushXml.js"></script>
	<title>アクション - S2Swing チュートリアル</title>
</head>
<body>

<h1>アクション</h1>

<p class="ref">
このページの内容に対応するソースコードは、s2swing-tutorialアーカイブのactionパッケージ以下にあります。
</p>

<p>
ここでは、@S2Actionアノテーションと@ActionTargetアノテーションを使ったアクションの定義方法について学習します。
</p>

<h2>アクションとは</h2>

<p>
javax.swing.Actionインタフェースで提供されるアクションを使用すると、ボタンやメニュー項目のクリックに対応する
「新規作成」や「上書き保存」といったひとまとまりの機能を、統一的に記述することが可能になります。
S2Swingでは、アノテーションやリソースファイルを活用して、このアクションをより便利に定義することができます。
</p>

<h2>フレームクラスの作成</h2>

<p>
それでは、以下のActionUsageFrameクラスを見てみましょう。
</p>

<pre name="code" class="java">
package action;

import java.awt.Container;
import java.awt.FlowLayout;

import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JOptionPane;

import org.seasar.swing.annotation.ActionTarget;
import org.seasar.swing.annotation.S2Action;
import org.seasar.swing.component.S2Frame;

public class ActionUsageFrame extends S2Frame {
    private static final long serialVersionUID = 1L;

    private JCheckBox checkBox = new JCheckBox();

    @ActionTarget("showMessage")
    private JButton button = new JButton();

    public void initialize() {
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        Container c = getContentPane();
        c.setLayout(new FlowLayout());
        c.add(checkBox);
        c.add(button);
    }

    public boolean isShowMessageEnabled() {
        return checkBox.isSelected();
    }

    @S2Action(enabled = "showMessageEnabled")
    public void showMessage() {
        JOptionPane.showMessageDialog(this, "Action performed.");
    }
}
</pre>

<p>
buttonフィールドに、@ActionTargetアノテーションで"showMessage"という文字列が指定されています。
これは、「buttonのクリック時にshowMessageアクションを呼び出しなさい」という指示になります。
</p>

<p>
showMessageアクションの処理内容は、showMessage()メソッドに記述されています。
S2Swingでは、引数を持たないpublicメソッドに@S2Actionアノテーションを付与することで、アクションを表現します。
このとき、メソッド名がそのままアクション名になります。
</p>

<p>
さらに上のコードでは、@S2Actionアノテーションにenabled引数として"showMessageEnabled"が指定されています。
これは、showMessageEnabledプロパティ、つまりisShowMessageEnabled()メソッドの戻り値がtrueのときに限り、
アクションを実行可能とすることを指示しています。この引数には、任意のOGNL式を指定できます。
</p>

<p class="remark">
@S2Actionアノテーションのenabledプロパティでは、Swing Application Frameworkの@Actionアノテーションにおける
enabledPropertyプロパティと違い、PropertyChangeEventを扱う必要がありません。
</p>

<h2>リソースファイルの作成</h2>

<p>
次に、ActionUsageFrameに対応するaction/resources/ActionUsageFrame.propertiesファイルを作成します。
</p>

<pre class="properties">
title = ActionUsage
checkBox.text = アクションを使用可能にする
showMessage.Action.text = メッセージを表示
</pre>

<p>
このように、[アクション名].Action.textというキーを使って、アクションの表示テキストを指定します。
</p>

<h2>アプリケーションの実行</h2>

<p>
それでは、ActionUsageアプリケーションを実行してみましょう。
</p>

<p>
<img src="images/action1.png" />
<img src="images/action2.png" />
</p>

<p>
チェックボックスをオンにしているときのみ、「メッセージを表示」ボタンがクリック可能になります。このときボタンをクリックすると、メッセージボックスが表示されます。
</p>

<p>
<img src="images/action3.png" />
</p>

<p>
従来のSwingアプリケーションと比較して、非常に簡潔な記述でアクションを制御できることが分かると思います。
</p>

<script type="text/javascript">
dp.SyntaxHighlighter.ClipboardSwf = "../syntax/swf/clipboard.swf";
dp.SyntaxHighlighter.HighlightAll("code");
</script>
</body>
</html>